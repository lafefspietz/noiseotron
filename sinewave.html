<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">

    <!--

Noiseotron Radio Source Control

    -->



    <!--Stop Google:-->
    <META NAME="robots" CONTENT="noindex,nofollow">

    <script src = "https://cdnjs.cloudflare.com/ajax/libs/showdown/1.8.6/showdown.js"></script>

    
<script src="https://cdn.jsdelivr.net/npm/p5@1.7.0/lib/p5.js"></script>
<script src = "https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.6.0/addons/p5.sound.js"></script>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script>
            MathJax.Hub.Config({
                tex2jax: {
                inlineMath: [['$','$'], ['\\(','\\)']],
                processEscapes: true,
                processClass: "mathjax",
                ignoreClass: "no-mathjax"
                }
            });//			MathJax.Hub.Typeset();//tell Mathjax to update the math
        </script>
</head>
<body>    
<a style = "font-size:2em" href = "readme.html">README</a>

<img style = "width:70px;position:absolute;right:300px;top:50px;z-index:1" id = "phplogo" src = "images/php-logo.png"/>
<table id = "jsonflow">
    <tr>
      
 
        <td>
            <img style = "width:120px" src = "images/python-logo.png"/></td>
        </td>
                <td>
            <img style = "transform:rotate(180deg);width:50px" src= "images/shortarrow.png"/>
        </td>
    </tr>
</table>
    
<table id = "knobtable">
    <tr>
        <td style = "color:red">
            $f_{sine}$ = <span id  = "fsinespan"></span> Hz
        </td>
    </tr>

    <tr>
        <td>
            <img src = "images/redknob.png"/>
        </td>
    </tr>
    <tr>
        <td style = "color:blue">
            $A_{sine}$ = <span id  = "asinespan"></span>
        </td>
    </tr>

    <tr>
        <td>
                <img src = "images/blueknob.png"/>
        </td>
    </tr>
</table>

<textarea id = "jsonbox"></textarea>

<div id = "jsontitle"><img src = "images/json.png"/><br>sinejson.txt</div>

<img id = "joinarrow" src=  "images/joinarrow.png"/>

<table id = "commandtable">
    <tr>
        <td style = "color:red;display:none">RED:<span id = "redspan"></span></td>
        <td style = "color:blue;display:none">BLUE:<span id = "bluespan"></span></td>
        <Td>COMMAND:</Td>
        <TD><INPUT id = "commandinput"/></TD>

        <td></td>
    </tr>
</table>

<script>

var osc;

fsine = 1000;//frequency in Hz
deltafsine = 25;//frequency change in Hz
asine = 0.25;//amplitude of sine wave in arbs
deltaasine = 0.05;

redknob = 0;

function setup(){
      createCanvas(1, 1);    
  osc = new p5.SinOsc(); // set frequency and type
  osc.amp(asine);   
  osc.freq(fsine);  
   osc.start();
   
}

function draw(){
  osc.amp(asine);   
  osc.freq(fsine);  
    
}

function mouseClicked() {
 

    
}
document.getElementById("redspan").innerHTML = redknob.toString();

document.getElementById("fsinespan").innerHTML = (fsine).toString();

document.getElementById("asinespan").innerHTML = (asine.toPrecision(3)).toString();

blueknob = 0;

document.getElementById("bluespan").innerHTML = blueknob.toString();

document.getElementById("commandinput").value = "";
document.getElementById("commandinput").select();




oscoff = true;
document.getElementById("commandinput").onchange = function(){


    command = this.value;
    if(command == "redpress" || command == "bluepress"){
        if(oscoff){
            osc.start();
        }
        else{
            osc.stop();
        }        
        oscoff = !oscoff;
    }
    if(command.includes("=")){
        variable = command.split("=")[0];
        number = parseFloat(command.split("=")[1]);
        if(variable == "f " || variable == "f"){
            fsine = number;
            fsine = Math.round(fsine);

            document.getElementById("fsinespan").innerHTML = (frf.toPrecision(0)).toString();
            savejson();
        } 
        if(variable == "a" || variable == "a " ||  variable == "p " || variable == "p"){
            asine = number;
            asine = Math.round(asine*100)/100;

            document.getElementById("asinespan").innerHTML = (asine.toPrecision(2)).toString();
            savejson();
        } 
        if(variable == "red" || variable == "red "){
            if(number > redknob){
                fsine = fsine + deltafsine;
            }
            if(number < redknob){
                fsine = fsine - deltafsine;
            }
            fsine = Math.round(fsine);
            redknob = number;        
            document.getElementById("redspan").innerHTML = redknob.toString();
                document.getElementById("fsinespan").innerHTML = (fsine).toString();
            savejson();
        }
        if(variable == "blue" || variable == "blue "){
            if(number > blueknob){
                asine = asine + deltaasine;
            }
            if(number < blueknob){
                asine = asine - deltaasine;
            }
            asine = (Math.round(asine*100))/100;

            blueknob = number;        
            document.getElementById("bluespan").innerHTML = blueknob.toString();
            document.getElementById("asinespan").innerHTML = (asine.toPrecision(3)).toString();
            savejson();
        }
    }
    
    this.value = "";
}


timestamp = Math.round((new Date().getTime())/1000).toString();

sinejson = {
    "fsine":fsine,
    "asine":asine,
    "timestamp":timestamp
};

function savejson(){
    timestamp = Math.round((new Date().getTime())/1000).toString();
    sinejson.fsine = fsine;
    sinejson.asine = asine;
    sinejson.timestamp = timestamp;
    document.getElementById("jsonbox").value = JSON.stringify(sinejson,null,"    ");
    var url = "filesaver.php";        
    var httpc2 = new XMLHttpRequest();
    httpc2.open("POST", url, true);
    httpc2.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
    httpc2.send("data="+encodeURIComponent(JSON.stringify(sinejson,null,"    "))+"&filename=sinejson.txt");//send text to filesaver.php
}
</script>
<style>
main canvas{
    position:absolute;
    right:0px;
    top:50px;
}
body{
    overflow:hidden;
    background-color:white;
    font-family:Arial;
}
#joinarrow{
    position:absolute;
    right:250px;
    top:10px;
    width:120px;
}
#jsonbox{
    position:absolute;
    width:150px;
    height:200px;
    right:400px;
    top:175px;
    border-radius:5px;
    font-size:14px;
    font-family:courier;
}
#jsontitle{
    position:absolute;
    top:10px;
    right:400px;
    font-size:24px;
    font-family:courier;
}
#jsontitle img{
    max-width:150px;
}
#title{
    width:10em;
    text-align:center;
    position:absolute;
    left:1px;
    top:1px;
    font-size:1.5em;
}
#schematic{
    position:absolute;
    left:0px;
    top:0px;
    height:100%;
    z-index:-1;
}
#knobtable{
    position:absolute;
    right:10px;
    top:10px;
    font-size:2em;
}
#knobtable img{
    max-width:130px;
}
#knobtable td{
    text-align:right;
}
a{
    color:blue;
}
#commandtable{
    position:absolute;
    right:0px;
    bottom:0px;
    font-size:2em;
}
#command{
    font-size:1em;
}
#jsonflow{
    top:10px;
    position:absolute;
    right:575px;
}
@media only screen and (orientation: landscape) {


}

@media only screen and (orientation: portrait) {

    
}
</style>
</body>
</html>